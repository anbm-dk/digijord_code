legend.title = ggtext::element_markdown(),
legend.key.size = unit(0.5, "line"),
legend.box.spacing = unit(1.5, "line"),
legend.justification = "left",
legend.margin = margin(0, 0, 0, 0),
legend.box.margin = margin(-10, -10, -10, -10),
plot.background = element_rect(fill = 'transparent', color = NA),
plot.margin = margin(0, 0, 0, 0, "cm")
) +
guides(col = guide_colourbar(title = "ŷ"))
}
library(grid)
library(ggpubr)
figure2 <- ggarrange(
pdp_plotlist2[[1]] + rremove("ylab"),
pdp_plotlist2[[2]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[3]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[4]] + rremove("ylab"),
pdp_plotlist2[[5]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[6]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[7]] + rremove("ylab"),
pdp_plotlist2[[8]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[9]] + rremove("ylab") + rremove("y.text"),
align = "hv",
nrow = 3,
ncol = 3
) +
theme(plot.margin = margin(0, 0, 0, 0, "cm"))
# figure2
tiff(
paste0(dir_results, "/pdp_texture_depth_combo_test_", testn, ".tiff"),
width = 16,
height = 12,
units = "cm",
res = 600
)
annotate_figure(
figure2,
left = text_grob(
"Depth (cm)",
rot = 90, vjust = 1,
# gp = gpar(cex = 1.3),
family = "serif"
)
)
try(dev.off())
try(dev.off())
pdp_plotlist2 <- list()
for (i in 1:nrow(combinations_pdp)) {
pdp_combo_i <- pdp_outlist_combo[[i]]
if (s2_indices[i]) {
pdp_combo_i %<>%
mutate(
x = x/10^4,
plotratio = plotratio/10^4
)
}
x_breaks <- c(
pdp_combo_i$x %>%
min() %>%
multiply_by(10^xlab_digits[i]) %>%
ceiling() %>%
divide_by(10^xlab_digits[i]),
pdp_combo_i$x %>%
max() %>%
multiply_by(10^xlab_digits[i]) %>%
floor() %>%
divide_by(10^xlab_digits[i])
)
pdp_plotlist2[[i]] <- pdp_combo_i %>%
ggplot() +
geom_raster(aes(x = x, y = Depth, fill = yhat)) +
coord_fixed(ratio = pdp_combo_i$plotratio[1], expand = FALSE) +
scale_y_reverse(breaks = c(0, 100, 200)) +
scale_x_continuous(
expand = c(0, 0),
breaks = x_breaks
) +
scale_fill_viridis_c(name = "ŷ", breaks = equal_breaks2(n = 2, s = 0.10)) +
ggtitle(frac_labels3[i]) +
xlab(cov_labels[i]) +
theme(
text = element_text(family = "serif"),
plot.title = element_markdown(margin = unit(c(0, 0, 0, 0), "cm")),
legend.title = ggtext::element_markdown(),
legend.key.size = unit(0.5, "line"),
legend.box.spacing = unit(1, "line"),
legend.justification = "left",
legend.margin = margin(0, 0, 0, 0),
legend.box.margin = margin(-10, -10, -10, -10),
plot.background = element_rect(fill = 'transparent', color = NA),
plot.margin = margin(0, 0, 0, 0, "cm")
) +
guides(col = guide_colourbar(title = "ŷ"))
}
library(grid)
library(ggpubr)
figure2 <- ggarrange(
pdp_plotlist2[[1]] + rremove("ylab"),
pdp_plotlist2[[2]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[3]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[4]] + rremove("ylab"),
pdp_plotlist2[[5]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[6]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[7]] + rremove("ylab"),
pdp_plotlist2[[8]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[9]] + rremove("ylab") + rremove("y.text"),
align = "hv",
nrow = 3,
ncol = 3
) +
theme(plot.margin = margin(0, 0, 0, 0, "cm"))
# figure2
tiff(
paste0(dir_results, "/pdp_texture_depth_combo_test_", testn, ".tiff"),
width = 16,
height = 12,
units = "cm",
res = 600
)
annotate_figure(
figure2,
left = text_grob(
"Depth (cm)",
rot = 90, vjust = 1,
# gp = gpar(cex = 1.3),
family = "serif"
)
)
try(dev.off())
try(dev.off())
?ggarrange
?theme
figure2 <- ggarrange(
pdp_plotlist2[[1]] + rremove("ylab"),
pdp_plotlist2[[2]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[3]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[4]] + rremove("ylab"),
pdp_plotlist2[[5]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[6]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[7]] + rremove("ylab"),
pdp_plotlist2[[8]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[9]] + rremove("ylab") + rremove("y.text"),
align = "hv",
nrow = 3,
ncol = 3
) +
theme(plot.margin = margin(0.1, 0.5, 0, 0.25, "cm"))
# figure2
tiff(
paste0(dir_results, "/pdp_texture_depth_combo_test_", testn, ".tiff"),
width = 16,
height = 12,
units = "cm",
res = 600
)
annotate_figure(
figure2,
left = text_grob(
"Depth (cm)",
rot = 90, vjust = 1,
# gp = gpar(cex = 1.3),
family = "serif"
)
)
try(dev.off())
try(dev.off())
pdp_plotlist2 <- list()
for (i in 1:nrow(combinations_pdp)) {
pdp_combo_i <- pdp_outlist_combo[[i]]
if (s2_indices[i]) {
pdp_combo_i %<>%
mutate(
x = x/10^4,
plotratio = plotratio/10^4
)
}
x_breaks <- c(
pdp_combo_i$x %>%
min() %>%
multiply_by(10^xlab_digits[i]) %>%
ceiling() %>%
divide_by(10^xlab_digits[i]),
pdp_combo_i$x %>%
max() %>%
multiply_by(10^xlab_digits[i]) %>%
floor() %>%
divide_by(10^xlab_digits[i])
)
pdp_plotlist2[[i]] <- pdp_combo_i %>%
ggplot() +
geom_raster(aes(x = x, y = Depth, fill = yhat)) +
coord_fixed(ratio = pdp_combo_i$plotratio[1], expand = FALSE) +
scale_y_reverse(breaks = c(0, 100, 200)) +
scale_x_continuous(
expand = c(0, 0),
breaks = x_breaks
) +
scale_fill_viridis_c(name = "ŷ", breaks = equal_breaks2(n = 2, s = 0.10)) +
ggtitle(frac_labels3[i]) +
xlab(cov_labels[i]) +
theme(
text = element_text(family = "serif"),
plot.title = element_markdown(margin = unit(c(0, 0, 0, 0), "cm")),
legend.title = ggtext::element_markdown(),
legend.key.size = unit(0.5, "line"),
legend.box.spacing = unit(1, "line"),
legend.justification = "left",
legend.margin = margin(0, 0, 0, 0),
legend.box.margin = margin(-10, -10, -10, -10),
plot.background = element_rect(fill = 'transparent', color = NA),
plot.margin = margin(0, 0, 0, 0, "cm"),
axis.title.x = element_text(vjust = +3)
) +
guides(col = guide_colourbar(title = "ŷ"))
}
library(grid)
library(ggpubr)
figure2 <- ggarrange(
pdp_plotlist2[[1]] + rremove("ylab"),
pdp_plotlist2[[2]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[3]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[4]] + rremove("ylab"),
pdp_plotlist2[[5]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[6]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[7]] + rremove("ylab"),
pdp_plotlist2[[8]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[9]] + rremove("ylab") + rremove("y.text"),
align = "hv",
nrow = 3,
ncol = 3
) +
theme(plot.margin = margin(0.1, 0.5, 0, 0.25, "cm"))
# figure2
tiff(
paste0(dir_results, "/pdp_texture_depth_combo_test_", testn, ".tiff"),
width = 16,
height = 12,
units = "cm",
res = 600
)
annotate_figure(
figure2,
left = text_grob(
"Depth (cm)",
rot = 90, vjust = 1,
# gp = gpar(cex = 1.3),
family = "serif"
)
)
try(dev.off())
try(dev.off())
pdp_plotlist2 <- list()
for (i in 1:nrow(combinations_pdp)) {
pdp_combo_i <- pdp_outlist_combo[[i]]
if (s2_indices[i]) {
pdp_combo_i %<>%
mutate(
x = x/10^4,
plotratio = plotratio/10^4
)
}
x_breaks <- c(
pdp_combo_i$x %>%
min() %>%
multiply_by(10^xlab_digits[i]) %>%
ceiling() %>%
divide_by(10^xlab_digits[i]),
pdp_combo_i$x %>%
max() %>%
multiply_by(10^xlab_digits[i]) %>%
floor() %>%
divide_by(10^xlab_digits[i])
)
pdp_plotlist2[[i]] <- pdp_combo_i %>%
ggplot() +
geom_raster(aes(x = x, y = Depth, fill = yhat)) +
coord_fixed(ratio = pdp_combo_i$plotratio[1], expand = FALSE) +
scale_y_reverse(breaks = c(0, 100, 200)) +
scale_x_continuous(
expand = c(0, 0),
breaks = x_breaks
) +
scale_fill_viridis_c(name = "ŷ", breaks = equal_breaks2(n = 2, s = 0.10)) +
ggtitle(frac_labels3[i]) +
xlab(cov_labels[i]) +
theme(
text = element_text(family = "serif"),
plot.title = element_markdown(margin = unit(c(0, 0, 0, 0), "cm")),
legend.title = ggtext::element_markdown(),
legend.key.size = unit(0.5, "line"),
legend.box.spacing = unit(1, "line"),
legend.justification = "left",
legend.margin = margin(0, 0, 0, 0),
legend.box.margin = margin(-10, -10, -10, -10),
plot.background = element_rect(fill = 'transparent', color = NA),
plot.margin = margin(0, 0, 0, 0, "cm"),
axis.title.x = element_text(vjust = +5)
) +
guides(col = guide_colourbar(title = "ŷ"))
}
library(grid)
library(ggpubr)
figure2 <- ggarrange(
pdp_plotlist2[[1]] + rremove("ylab"),
pdp_plotlist2[[2]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[3]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[4]] + rremove("ylab"),
pdp_plotlist2[[5]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[6]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[7]] + rremove("ylab"),
pdp_plotlist2[[8]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[9]] + rremove("ylab") + rremove("y.text"),
align = "hv",
nrow = 3,
ncol = 3
) +
theme(plot.margin = margin(0.1, 0.5, 0, 0.25, "cm"))
# figure2
tiff(
paste0(dir_results, "/pdp_texture_depth_combo_test_", testn, ".tiff"),
width = 16,
height = 12,
units = "cm",
res = 600
)
annotate_figure(
figure2,
left = text_grob(
"Depth (cm)",
rot = 90, vjust = 1,
# gp = gpar(cex = 1.3),
family = "serif"
)
)
try(dev.off())
try(dev.off())
tiff(
paste0(dir_results, "/pdp_texture_depth_combo_test_", testn, ".tiff"),
width = 16,
height = 11,
units = "cm",
res = 600
)
annotate_figure(
figure2,
left = text_grob(
"Depth (cm)",
rot = 90, vjust = 1,
# gp = gpar(cex = 1.3),
family = "serif"
)
)
try(dev.off())
try(dev.off())
?theme
pdp_plotlist2 <- list()
for (i in 1:nrow(combinations_pdp)) {
pdp_combo_i <- pdp_outlist_combo[[i]]
if (s2_indices[i]) {
pdp_combo_i %<>%
mutate(
x = x/10^4,
plotratio = plotratio/10^4
)
}
x_breaks <- c(
pdp_combo_i$x %>%
min() %>%
multiply_by(10^xlab_digits[i]) %>%
ceiling() %>%
divide_by(10^xlab_digits[i]),
pdp_combo_i$x %>%
max() %>%
multiply_by(10^xlab_digits[i]) %>%
floor() %>%
divide_by(10^xlab_digits[i])
)
pdp_plotlist2[[i]] <- pdp_combo_i %>%
ggplot() +
geom_raster(aes(x = x, y = Depth, fill = yhat)) +
coord_fixed(ratio = pdp_combo_i$plotratio[1], expand = FALSE) +
scale_y_reverse(breaks = c(0, 100, 200)) +
scale_x_continuous(
expand = c(0, 0),
breaks = x_breaks
) +
scale_fill_viridis_c(name = "ŷ", breaks = equal_breaks2(n = 2, s = 0.10)) +
ggtitle(frac_labels3[i]) +
xlab(cov_labels[i]) +
theme(
text = element_text(family = "serif"),
plot.title = element_markdown(margin = unit(c(0, 0, 0, 0), "cm")),
legend.title = ggtext::element_markdown(),
legend.key.size = unit(0.5, "line"),
legend.box.spacing = unit(1, "line"),
legend.justification = "left",
legend.margin = margin(0, 0, 0, 0),
legend.box.margin = margin(-10, -10, -10, -10),
plot.background = element_rect(fill = 'transparent', color = NA),
plot.margin = margin(0, 0, 0, 0.1, "cm"),
axis.title.x = element_text(vjust = +5)
) +
guides(col = guide_colourbar(title = "ŷ"))
}
library(grid)
library(ggpubr)
figure2 <- ggarrange(
pdp_plotlist2[[1]] + rremove("ylab"),
pdp_plotlist2[[2]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[3]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[4]] + rremove("ylab"),
pdp_plotlist2[[5]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[6]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[7]] + rremove("ylab"),
pdp_plotlist2[[8]] + rremove("ylab") + rremove("y.text"),
pdp_plotlist2[[9]] + rremove("ylab") + rremove("y.text"),
align = "hv",
nrow = 3,
ncol = 3
) +
theme(plot.margin = margin(0.1, 0.5, 0, 0.25, "cm"))
# figure2
tiff(
paste0(dir_results, "/pdp_texture_depth_combo_test_", testn, ".tiff"),
width = 16,
height = 11,
units = "cm",
res = 600
)
annotate_figure(
figure2,
left = text_grob(
"Depth (cm)",
rot = 90, vjust = 1,
# gp = gpar(cex = 1.3),
family = "serif"
)
)
try(dev.off())
try(dev.off())
pdp_plotlist1 <- list()
for (i in 1:length(frac_ind_predict)) {
pdp_plotlist1[[i]] <- pdp_depth_mean %>%
mutate(
S1_VH_spring = filled_s1_baresoil_composite_vh_8_days/100
) %>%
filter(Fraction == fractions[frac_ind_predict[i]]) %>%
ggplot() +
geom_raster(aes(x = S1_VH_spring, y = Depth, fill = yhat)) +
scale_fill_viridis_c(name = "ŷ", breaks = equal_breaks2(n = 2, s = 0.10)) +
coord_fixed(ratio = plotratio/100, expand = FALSE) +
scale_y_reverse(breaks = c(0, 100, 200)) +
scale_x_continuous(breaks = equal_breaks2(n = 2, s = 0.10)) +
labs(title = paste0(LETTERS[i], ": ", frac_labels2[frac_ind_predict[i]])) +
theme(
text = element_text(family = "serif"),
plot.title = element_markdown(margin = unit(c(0, 0, -0.05, 0), "cm")),
legend.title = ggtext::element_markdown(),
legend.key.size = unit(0.5, "line"),
legend.box.spacing = unit(1, "line"),
legend.justification = "left",
legend.margin = margin(0, 0, 0, 0),
legend.box.margin = margin(-10, -10, -10, -10),
plot.background = element_rect(fill = 'transparent', color = NA),
plot.margin = margin(0, 0, 0, 0, "cm")
) +
guides(col = guide_colourbar(title = "ŷ"))
}
library(grid)
library(ggpubr)
figure <- ggarrange(
pdp_plotlist1[[1]] + rremove("ylab") + rremove("xlab") + rremove("x.text"),
pdp_plotlist1[[2]] +
rremove("ylab") +
rremove("xlab") +
rremove("x.text") +
rremove("y.text"),
pdp_plotlist1[[3]] + rremove("ylab") + rremove("xlab") + rremove("y.text"),
pdp_plotlist1[[4]] + rremove("ylab") + rremove("xlab"),
pdp_plotlist1[[5]] + rremove("ylab") + rremove("xlab") + rremove("y.text"),
align = "hv",
nrow = 2,
ncol = 3
# ,
# labels = fractions[frac_ind_predict]
) +
theme(plot.margin = margin(0.1, 0.5, 0, 0.25, "cm"))
figure
tiff(
paste0(dir_results, "/pdp_texture_depth_VH_test_", testn, ".tiff"),
width = 16,
height = 6.7,
units = "cm",
res = 600
)
annotate_figure(
figure,
left = text_grob(
"Depth (cm)",
rot = 90, vjust = 1,
# gp = gpar(cex = 1.3),
family = "serif"
),
bottom = text_grob(
"S1 VH - Bare (dB)",
# gp = gpar(cex = 1.3),
family = "serif"
)
)
try(dev.off())
try(dev.off())
