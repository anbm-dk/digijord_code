across(
c(LER, SILT, GRVSILT, S63, S125, S200, S500, HUMUS, CACO3),
~ case_when(
TEKTURSUM_NY == 0 ~ NA,
.default = .)
)
) %>%
mutate(
across(
c(LER, SILT, GRVSILT, S63, S125, S200, S500),
~ case_when(
TEKSTUR_NZERO > 1 & . == 0 ~ NA,
.default = .)
)
) %>%
mutate(
HUMUS = case_when(
HUMUS == 0 & CACO3 > 0 & tminsum == 0 ~ NA,
HUMUS == 0 & CACO3 > 0 & is.na(tminsum) ~ NA,
.default = HUMUS
)
) %>% as.data.frame() %>% filter(CACO3 > 0 & tminsum == 0)
profiles_tex2 %>%
mutate(
across(
c(LER, SILT, GRVSILT, S63, S125, S200, S500, HUMUS, CACO3),
~ case_when(
TEKTURSUM_NY == 0 ~ NA,
.default = .)
)
) %>%
mutate(
across(
c(LER, SILT, GRVSILT, S63, S125, S200, S500),
~ case_when(
TEKSTUR_NZERO > 1 & . == 0 ~ NA,
.default = .)
)
) %>%
mutate(
HUMUS = case_when(
HUMUS == 0 & CACO3 > 0 & tminsum == 0 ~ NA,
HUMUS == 0 & CACO3 > 0 & is.na(tminsum) ~ NA,
.default = HUMUS
)
) %>% as.data.frame() %>% filter(CACO3 > 0 & tminsum == 0 & is.na(HUMUS))
profiles_tex2 %>% as.data.frame() %>% filter(CACO3 > 0 & tminsum == 0 & HUMUS == 0)
profiles_tex2 %>% filter(
PROFILNR == 975
)
profiles_tex2 %>%
rowwise() %>%
mutate(
S500 = case_when(
PROFILNR == 975 & HORISONTNR == 4 ~ 100 - sum(
LER, SILT, GRVSILT, S63, S125, S200, HUMUS, CACO3, na.rm = TRUE
),
.default = S500
)
) %>% ungroup() %>% filter(
PROFILNR == 975
)
profiles_tex2 %>% filter(
PROFILNR == 975
) %>% as.data.frame()
?lag
lag(1:5)
lead(1:5)
lag("S500", order_by = colnames(profiles_tex2))
colnames(profiles_tex2)
distinct()
?distinct
profiles_tex2 %>% filter(1:10)
profiles_tex2 %>% filter(10)
profiles_tex2 %>% sample_n(10)
profiles_tex2
?sample_n
profiles_tex2 %>% slice_sample(n = 10)
?lag
?cur_data_all
?accumulate
?all
?c_across
profiles_tex2 %>% slice_sample(n = 10) %>%
rowwise() %>%
mutate(new = sum(c_across(LER, SILT, GRVSILT, S63, S125, S200, S500
) == lag(c_across(LER, SILT, GRVSILT, S63, S125, S200,
S500))))
profiles_tex2 %>% slice_sample(n = 10) %>%
rowwise() %>%
mutate(new = sum(c_across(c(LER, SILT, GRVSILT, S63, S125, S200, S500)
) == lag(c_across(c(LER, SILT, GRVSILT, S63, S125, S200,
S500)))))
profiles_tex2 %>% slice_sample(n = 10)
?slice_sample
profiles_tex2 %>% slice_sample(n = 10)
profiles_tex2
profiles_tex2 %>% slice_head(n = 10)
profiles_tex2 %>% slice_head(n = 10) %>% str()
profiles_tex2 %<>% ungroup()
profiles_tex2 %>% slice_sample(n = 10)
profiles_tex2 %>% slice_head(n = 10) %>% str()
rowwise() %>%
mutate(
new = sum(
c_across(
c(LER, SILT, GRVSILT, S63, S125, S200, S500)
) == lag(c_across(c(LER, SILT, GRVSILT, S63, S125, S200, S500))))
) %>%
as.data.frame()
profiles_tex2 %<>% ungroup()
profiles_tex2 %>% slice_head(n = 10) %>%
rowwise() %>%
mutate(
new = sum(
c_across(
c(LER, SILT, GRVSILT, S63, S125, S200, S500)
) == lag(c_across(c(LER, SILT, GRVSILT, S63, S125, S200, S500))))
) %>%
as.data.frame()
profiles_tex2 %>% slice_sample(n = 10) %>%
rowwise() %>%
mutate(
new = sum(
c_across(
c(LER, SILT, GRVSILT, S63, S125, S200, S500)
) == lag(c_across(c(LER, SILT, GRVSILT, S63, S125, S200, S500))))
) %>%
as.data.frame()
?c_across
c(1:10) == rep(1:10)
c(1:10) == rep(1, 10)
profiles_tex2 %>% slice_sample(n = 10) %>%
rowwise() %>%
mutate(
new = sum(
c_across(
LER, SILT, GRVSILT, S63, S125, S200, S500
) == lag(c_across(LER, SILT, GRVSILT, S63, S125, S200, S500)))
) %>%
as.data.frame()
profiles_tex2 %>% slice_sample(n = 10) %>%
rowwise() %>%
mutate(
new = sum(
c_across(
LER:S500
) == lag(c_across(LER:S500)))
) %>%
as.data.frame()
profiles_tex2 %>% slice_sample(n = 10) %>%
rowwise() %>%
mutate(
new = sum(
c_across(
LER:S500
) == lag(c_across(LER:S500)), na.rm = TRUE)
) %>%
as.data.frame()
vec <- c(1, 1, 2, 2)
t_first <- vec[match(unique(vec), vec)]
t_first
t_first <- match(unique(vec), vec)
t_first
1:length(vec) %in% t_first
firsts <- 1:length(vec) %in% t_first
?pick
profiles_tex2 %>% slice_head(n = 10) %>%
rowwise() %>%
mutate(
new = sum(
c_across(
LER:S500
) == lag(c_across(LER:S500)), na.rm = TRUE)
) %>%
as.data.frame()
profiles_tex2 %>% slice_head(n = 10) %>%
rowwise() %>%
mutate(
across(
~ 1:7 %in% match(unique(LER:S500), LER:S500)[c("LER", "SILT", "GRVSILT", "S63", "S125", "S200", "S500") %in% cur_column()]
)
) %>%
as.data.frame()
profiles_tex2 %>% slice_head(n = 10) %>%
rowwise() %>%
mutate(
across(
c(LER, SILT, GRVSILT, S63, S125, S200, S500),
~ 1:7 %in% match(unique(LER:S500), LER:S500)[c("LER", "SILT", "GRVSILT", "S63", "S125", "S200", "S500") %in% cur_column()]
)
) %>%
as.data.frame()
profiles_tex2 %>% slice_head(n = 10) %>%
rowwise() %>%
mutate(
across(
c(LER, SILT, GRVSILT, S63, S125, S200, S500),
~ 1:7 %in% match(unique(LER:S500), LER:S500)[c("LER", "SILT", "GRVSILT", "S63", "S125", "S200", "S500") %in% cur_column()]
)
)
profiles_tex2 %>% slice_head(n = 10) %>%
rowwise() %>%
mutate(
across(
c(LER, SILT, GRVSILT, S63, S125, S200, S500),
~ 1:7[c("LER", "SILT", "GRVSILT", "S63", "S125", "S200", "S500") %in% cur_column()]# %in% match(unique(LER:S500), LER:S500)[c("LER", "SILT", "GRVSILT", "S63", "S125", "S200", "S500") %in% cur_column()]
)
) %>%
as.data.frame()
profiles_tex2 %>% slice_head(n = 10) %>%
rowwise() %>%
mutate(
across(
c(LER, SILT, GRVSILT, S63, S125, S200, S500),
~ cur_column() #~ 1:7[c("LER", "SILT", "GRVSILT", "S63", "S125", "S200", "S500") %in% cur_column()]# %in% match(unique(LER:S500), LER:S500)[c("LER", "SILT", "GRVSILT", "S63", "S125", "S200", "S500") %in% cur_column()]
)
) %>%
as.data.frame()
profiles_tex2 %>% slice_head(n = 10) %>%
rowwise() %>%
mutate(
across(
c(LER, SILT, GRVSILT, S63, S125, S200, S500),
~ match(cur_column(), c("LER", "SILT", "GRVSILT", "S63", "S125", "S200", "S500")) #~ 1:7[c("LER", "SILT", "GRVSILT", "S63", "S125", "S200", "S500") %in% cur_column()]# %in% match(unique(LER:S500), LER:S500)[c("LER", "SILT", "GRVSILT", "S63", "S125", "S200", "S500") %in% cur_column()]
)
) %>%
as.data.frame()
profiles_tex2 %>% slice_head(n = 10) %>%
rowwise() %>%
mutate(
across(
c(LER, SILT, GRVSILT, S63, S125, S200, S500),
~ match(cur_column(), t_colnames) #~ 1:7[c("LER", "SILT", "GRVSILT", "S63", "S125", "S200", "S500") %in% cur_column()]# %in% match(unique(LER:S500), LER:S500)[c("LER", "SILT", "GRVSILT", "S63", "S125", "S200", "S500") %in% cur_column()]
)
) %>%
as.data.frame()
t_colnames <- c("LER", "SILT", "GRVSILT", "S63", "S125", "S200", "S500")
profiles_tex2 %>% slice_head(n = 10) %>%
rowwise() %>%
mutate(
across(
c(LER, SILT, GRVSILT, S63, S125, S200, S500),
~ match(cur_column(), t_colnames) #~ 1:7[c("LER", "SILT", "GRVSILT", "S63", "S125", "S200", "S500") %in% cur_column()]# %in% match(unique(LER:S500), LER:S500)[c("LER", "SILT", "GRVSILT", "S63", "S125", "S200", "S500") %in% cur_column()]
)
) %>%
as.data.frame()
c(1,1)[0]
c(1,1)[0] ==1
?ifelse
profiles_tex2 %>% slice_head(n = 10) %>%
rowwise() %>%
mutate(
across(
c(LER, SILT, GRVSILT, S63, S125, S200, S500),
~ ifelse(c_across(LER:S500)[match(cur_column(), t_colnames) - 1] == .,
NA, .) #~ # %in% match(unique(LER:S500), LER:S500)
)
) %>%
as.data.frame()
profiles_tex2 %>% slice_head(n = 10) %>%
rowwise() %>%
mutate(
across(
c(LER, SILT, GRVSILT, S63, S125, S200, S500),
~ case_when(
c_across(LER:S500)[match(cur_column(), t_colnames) - 1] == . ~ NA
.default = .
profiles_tex2 %>% slice_head(n = 10) %>%
rowwise() %>%
mutate(
across(
c(LER, SILT, GRVSILT, S63, S125, S200, S500),
~ case_when(
c_across(LER:S500)[match(cur_column(), t_colnames) - 1] == . ~ NA,
.default = .
) #~ # %in% match(unique(LER:S500), LER:S500)
)
) %>%
as.data.frame()
profiles_tex2 %>% slice_head(n = 10) %>%
rowwise() %>%
mutate(
across(
c(LER, SILT, GRVSILT, S63, S125, S200, S500),
~ c_across(LER:S500)[match(cur_column(), t_colnames)]
# case_when(
# c_across(LER:S500)[match(cur_column(), t_colnames) - 1] == . ~ NA,
#        .default = .
) #~ # %in% match(unique(LER:S500), LER:S500)
) %>%
as.data.frame()
profiles_tex2 %>% slice_head(n = 10) %>%
rowwise() %>%
mutate(
across(
c(SILT, GRVSILT, S63, S125, S200, S500),
~ c_across(LER:S500)[match(cur_column(), t_colnames) - 1]
# case_when(
# c_across(LER:S500)[match(cur_column(), t_colnames) - 1] == . ~ NA,
#        .default = .
) #~ # %in% match(unique(LER:S500), LER:S500)
) %>%
as.data.frame()
profiles_tex2 %>% slice_head(n = 10) %>%
rowwise() %>%
mutate(
across(
c(SILT, GRVSILT, S63, S125, S200, S500),
~ c_across(LER:S500)[match(cur_column(), t_colnames) - 1] == .
# case_when(
# c_across(LER:S500)[match(cur_column(), t_colnames) - 1] == . ~ NA,
#        .default = .
) #~ # %in% match(unique(LER:S500), LER:S500)
) %>%
as.data.frame()
profiles_tex2 %>% slice_head(n = 10) %>%
rowwise() %>%
mutate(
across(
c(SILT, GRVSILT, S63, S125, S200, S500),
~ case_when(
c_across(LER:S500)[match(cur_column(), t_colnames) - 1] == . ~ NA,
.default = .
)
# case_when(
# c_across(LER:S500)[match(cur_column(), t_colnames) - 1] == . ~ NA,
#        .default = .
) #~ # %in% match(unique(LER:S500), LER:S500)
) %>%
as.data.frame()
profiles_tex2 %>%
filter(TEKTURSUM_NY > 101) %>%
rowwise() %>%
mutate(
across(
c(SILT, GRVSILT, S63, S125, S200, S500),
~ case_when(
TEKTURSUM_NY > 101 &
c_across(LER:S500)[match(cur_column(), t_colnames) - 1] == . ~ NA,
.default = .
)
# case_when(
# c_across(LER:S500)[match(cur_column(), t_colnames) - 1] == . ~ NA,
#        .default = .
) #~ # %in% match(unique(LER:S500), LER:S500)
) %>%
as.data.frame()
profiles_tex2 %>%
rowwise() %>%
mutate(
across(
c(SILT, GRVSILT, S63, S125, S200, S500),
~ case_when(
TEKTURSUM_NY > 101 &
c_across(LER:S500)[match(cur_column(), t_colnames) - 1] == . ~ NA,
.default = .
)
# case_when(
# c_across(LER:S500)[match(cur_column(), t_colnames) - 1] == . ~ NA,
#        .default = .
) #~ # %in% match(unique(LER:S500), LER:S500)
) %>%
filter(TEKTURSUM_NY > 101) %>%
as.data.frame()
profiles_tex2 %>% slice_head(n = 10)
rowwise() %>%
mutate(
across(
c(SILT, GRVSILT, S63, S125, S200, S500),
~ case_when(
TEKTURSUM_NY > 101 & c_across(LER:S500)[match(cur_column(), t_colnames) - 1] == . ~ NA,
.default = .
)
# case_when(
# c_across(LER:S500)[match(cur_column(), t_colnames) - 1] == . ~ NA,
#        .default = .
) #~ # %in% match(unique(LER:S500), LER:S500)
) %>%
# filter(TEKTURSUM_NY > 101) %>%
as.data.frame()
profiles_tex2 %>% slice_head(n = 10) %>%
rowwise() %>%
mutate(
across(
c(SILT, GRVSILT, S63, S125, S200, S500),
~ case_when(
TEKTURSUM_NY > 101 & c_across(LER:S500)[match(cur_column(), t_colnames) - 1] == . ~ NA,
.default = .
)
# case_when(
# c_across(LER:S500)[match(cur_column(), t_colnames) - 1] == . ~ NA,
#        .default = .
) #~ # %in% match(unique(LER:S500), LER:S500)
) %>%
# filter(TEKTURSUM_NY > 101) %>%
as.data.frame()
profiles_tex2 %<>% ungroup()
t_colnames <- c("LER", "SILT", "GRVSILT", "S63", "S125", "S200", "S500")
profiles_tex2 %>%
rowwise() %>%
mutate(
across(
c(SILT, GRVSILT, S63, S125, S200, S500),
~ case_when(
TEKTURSUM_NY > 101 & c_across(LER:S500)[match(cur_column(), t_colnames) - 1] == . ~ NA,
.default = .
)
)
) %>%
rowwise() %>%
mutate(
across(
c(LER, SILT, GRVSILT, S63, S125, S200, S500),
~ case_when(
TEKSTUR_NZERO > 1 & . == 0 ~ NA,
.default = .)
)
) %>%
rowwise() %>%
mutate(
S500 = case_when(
PROFILNR == 975 & HORISONTNR == 4 ~ 100 - sum(
LER, SILT, GRVSILT, S63, S125, S200, HUMUS, CACO3, na.rm = TRUE
),
.default = S500
)
) %>%
ungroup() %>%
mutate(
across(
c(LER, SILT, GRVSILT, S63, S125, S200, S500, HUMUS, CACO3),
~ case_when(
TEKTURSUM_NY == 0 ~ NA,
.default = .)
)
) %>%
mutate(
HUMUS = case_when(
HUMUS == 0 & CACO3 > 0 & tminsum == 0 ~ NA,
HUMUS == 0 & CACO3 > 0 & is.na(tminsum) ~ NA,
.default = HUMUS
)
)
profiles_tex2 %<>% ungroup()
t_colnames <- c("LER", "SILT", "GRVSILT", "S63", "S125", "S200", "S500")
profiles_tex4 <- profiles_tex2 %>%
rowwise() %>%
mutate(
across(
c(SILT, GRVSILT, S63, S125, S200, S500),
~ case_when(
TEKTURSUM_NY > 101 & c_across(LER:S500)[match(cur_column(), t_colnames) - 1] == . ~ NA,
.default = .
)
)
) %>%
rowwise() %>%
mutate(
across(
c(LER, SILT, GRVSILT, S63, S125, S200, S500),
~ case_when(
TEKSTUR_NZERO > 1 & . == 0 ~ NA,
.default = .)
)
) %>%
rowwise() %>%
mutate(
S500 = case_when(
PROFILNR == 975 & HORISONTNR == 4 ~ 100 - sum(
LER, SILT, GRVSILT, S63, S125, S200, HUMUS, CACO3, na.rm = TRUE
),
.default = S500
)
) %>%
ungroup() %>%
mutate(
across(
c(LER, SILT, GRVSILT, S63, S125, S200, S500, HUMUS, CACO3),
~ case_when(
TEKTURSUM_NY == 0 ~ NA,
.default = .)
)
) %>%
mutate(
HUMUS = case_when(
HUMUS == 0 & CACO3 > 0 & tminsum == 0 ~ NA,
HUMUS == 0 & CACO3 > 0 & is.na(tminsum) ~ NA,
.default = HUMUS
)
)
profiles_tex4 %<>%
rowwise() %>%
mutate(
TEKTURSUM_NY = sum(LER, SILT, GRVSILT, S63, S125, S200, S500, HUMUS, CACO3,
na.rm = TRUE)
) %>%
ungroup()
plot(profiles_tex4$TEKTURSUM_NY)
profiles_tex4 %>% filter(TEKTURSUM_NY > 101)
profiles_tex4 %>% filter(TEKTURSUM_NY > 101) %>% as.data.frame()
profiles_tex2 %>% filter(PROFILNR3180)
profiles_tex2 %>% filter(PROFILNR == 3180)
profiles_tex2 %>% filter(PROFILNR == 3180) %>% as.data.frame()
plot(profiles_tex4$HUMUS, profiles_tex4$`TOTAL KULSTOF`)
cor(profiles_tex4$HUMUS, profiles_tex4$`TOTAL KULSTOF`)
?cor
cor(profiles_tex4$HUMUS, profiles_tex4$`TOTAL KULSTOF`, use = "pairwise.complete.obs")
plot(profiles_tex4$HUMUS, profiles_tex4$`TOTAL KULSTOF`)
plot(log(profiles_tex4$HUMUS), log(profiles_tex4$`TOTAL KULSTOF`))
cor(log(profiles_tex4$HUMUS), log(profiles_tex4$`TOTAL KULSTOF`), use = "pairwise.complete.obs")
cor(log(profiles_tex4$HUMUS), log(profiles_tex4$`TOTAL KULSTOF`), use = "pairwise.complete.obs", method = "spearman")
