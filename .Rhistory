)
maps_10_km
names(maps_10_km) <- c("SOM_remov", "SOM_norem")
plot(maps_10_km[[1]][[1]][[1]])
plot(maps_10_km[[2]][[1]][[1]])
plot(maps_10_km[[2]][[1]][[1]] - maps_10_km[[1]][[1]][[1]])
somrem_names <- c("SOM_remov", "SOM_norem")
maps_10_km
try(dev.off())
for (i in 1:somrem_names) {
lapply(1:4, function(x) {
fname <- paste0(
dir_results, "/",
fractions[x],
"_", somrem_names[i],
"_10km_test",
testn, ".tiff"
)
myplot <- autoplot(maps_10_km[[i]][[x]]) +
scale_fill_gradientn(colours = viridis(100), na.value = NA)
tiff(
fname,
width = 16,
height = 14,
units = "cm",
res = 300
)
print(myplot)
try(dev.off())
try(dev.off())
})
}
somrem_names <- c("SOM_remov", "SOM_norem")
try(dev.off())
for (i in 1:somrem_names) {
lapply(1:4, function(x) {
fname <- paste0(
dir_results, "/",
fractions[x],
"_", somrem_names[i],
"_10km_test",
testn, ".tiff"
)
myplot <- autoplot(maps_10_km[[i]][[x]]) +
scale_fill_gradientn(colours = viridis(100), na.value = NA)
tiff(
fname,
width = 16,
height = 14,
units = "cm",
res = 300
)
print(myplot)
try(dev.off())
try(dev.off())
})
}
somrem_names <- c("SOM_remov", "SOM_norem")
try(dev.off())
for (i in 1:length(somrem_names)) {
lapply(1:4, function(x) {
fname <- paste0(
dir_results, "/",
fractions[x],
"_", somrem_names[i],
"_10km_test",
testn, ".tiff"
)
myplot <- autoplot(maps_10_km[[i]][[x]]) +
scale_fill_gradientn(colours = viridis(100), na.value = NA)
tiff(
fname,
width = 16,
height = 14,
units = "cm",
res = 300
)
print(myplot)
try(dev.off())
try(dev.off())
})
}
try(dev.off())
lapply(5:6, function(x) {
fname <- paste0(dir_results, "/", fractions[x], "_10km_test", testn, ".tiff")
myplot <- autoplot(maps_10_km[[1]][[x]]) +
scale_fill_gradientn(colours = viridis(100), na.value = NA)
tiff(
fname,
width = 16,
height = 14,
units = "cm",
res = 300
)
print(myplot)
try(dev.off())
try(dev.off())
})
myrgb <- col2rgb(mycolors)
tsp <- as.TSP(dist(t(myrgb)))
set.seed(1)
sol <- solve_TSP(tsp, control = list(repetitions = 1e3))
ordered_cols <- mycolors[sol]
classes_in_maps <- values(maps_10km_jb) %>%
unlist() %>%
matrix(ncol = 1) %>%
unique() %>%
sort()
cols_in_maps <- ordered_cols[classes_in_maps]
maps_10km_jb_list
maps_10km_jb_list <- list()
maps_10km_jb_list$SOM_remov <- subset(maps_10km_jb, c(5:8))
maps_10km_jb_list$SOM_norem <- subset(maps_10km_jb, c(1:4))
jb_lyrnames <- paste0("JB class, ", uppers, " - ", lowers, " cm")
names(maps_10km_jb_list$SOM_norem) <- jb_lyrnames
names(maps_10km_jb_list$SOM_remov) <- jb_lyrnames
myrgb <- col2rgb(mycolors)
tsp <- as.TSP(dist(t(myrgb)))
set.seed(1)
sol <- solve_TSP(tsp, control = list(repetitions = 1e3))
ordered_cols <- mycolors[sol]
classes_in_maps <- values(maps_10km_jb) %>%
unlist() %>%
matrix(ncol = 1) %>%
unique() %>%
sort()
cols_in_maps <- ordered_cols[classes_in_maps]
plot_jb <- lapply(
maps_10km_jb_list,
function(x) {
out <- autoplot(x) +
scale_fill_discrete(type = cols_in_maps)
return(out)
}
)
maps_raw_paths
maps_10km_jb_list
for (i in 1:2) {
tiff(
paste0(dir_results, "/JB_", somrem_names[i],"_test_", testn, ".tiff"),
width = 16,
height = 14,
units = "cm",
res = 300
)
print(plot_jb[[i]])
try(dev.off())
}
clay_SOM_rem <- c(maps_10_km[[1]][[1]][[1]], maps_10_km[[2]][[1]][[1]])
plot(clay_SOM_rem)
autoplot(clay_SOM_rem)
clay_SOM_rem <- c(maps_10_km[[1]][[1]][[1]], maps_10_km[[2]][[1]][[1]])
names(clay_SOM_rem) <- c("SOM removed", "No SOM removal")
autoplot(clay_SOM_rem)
autoplot(clay_SOM_rem) +
scale_fill_gradientn(colours = viridis(100), na.value = NA)
autoplot(clay_SOM_rem) +
scale_fill_gradientn(colours = viridis(100), na.value = NA) +
ggtitle("Clay (%), 0 - 30 cm depth") +
theme(plot.title = element_text(hjust = 0.5))
clay_difference <- maps_10_km[[1]][[1]][[1]] - maps_10_km[[2]][[1]][[1]]
autoplot(clay_difference) +
scale_fill_gradientn(colours = viridis(100), na.value = NA) +
ggtitle("Effect of SOM removal") +
theme(plot.title = element_text(hjust = 0.5))
autoplot(clay_difference) +
scale_fill_gradientn(colours = viridis(100), na.value = NA) +
ggtitle("Effect of SOM removal, clay (%) difference") +
theme(plot.title = element_text(hjust = 0.5))
JB_SOM_rem <- c(maps_10km_jb_list[[1]][[1]], maps_10km_jb_list[[2]][[1]])
JB_SOM_rem <- c(maps_10km_jb_list[[1]][[1]], maps_10km_jb_list[[2]][[1]])
names(JB_SOM_rem) <- c("SOM removed", "No SOM removal")
autoplot(JB_SOM_rem) +
scale_fill_discrete(type = cols_in_maps) +
ggtitle("JB, 0 - 30 cm depth") +
theme(plot.title = element_text(hjust = 0.5))
c(clay_difference, maps_10_km[[1]][[1]][[5]]) %>% values() %>% plot()
c(clay_difference, maps_10_km[[1]][[1]][[5]]) %>% values()
c(clay_difference, maps_10_km[[1]][[1]][[5]])
maps_10_km
c(clay_difference, maps_10_km[[1]][[5]][[1]]) %>% values() %>% plot()
c(clay_difference, maps_10_km[[1]][[5]][[1]]) %>% spatSample(1000)
c(clay_difference, maps_10_km[[1]][[5]][[1]]) %>% spatSample(1000) %>% plot()
c(log(maps_10_km[[1]][[5]][[1]]), clay_difference) %>% spatSample(1000) %>% plot()
c(log(maps_10_km[[1]][[5]][[1]]), clay_difference) %>% spatSample(10000) %>% plot()
c(log(maps_10_km[[1]][[5]][[1]]), clay_difference) %>%
spatSample(10000) %>%
autoplot()
c(log(maps_10_km[[1]][[5]][[1]]), clay_difference) %>%
spatSample(10000) %>%
ggplot() +
geom_point()
?aes
c(log(maps_10_km[[1]][[5]][[1]]), clay_difference) %>%
spatSample(10000) %>%
rename(
log_SOC = 1,
clay_dif = 2
) %>%
ggplot(aes(x = log_soc, y = clay_dif)) +
geom_point() +
geom_smooth()
c(log(maps_10_km[[1]][[5]][[1]]), clay_difference) %>%
spatSample(10000) %>%
rename(
log_soc = 1,
clay_dif = 2
) %>%
ggplot(aes(x = log_soc, y = clay_dif)) +
geom_point() +
geom_smooth()
c(maps_10_km[[1]][[5]][[1]], clay_difference) %>%
spatSample(10000) %>%
rename(
log_soc = 1,
clay_dif = 2
) %>%
ggplot(aes(x = log_soc, y = clay_dif)) +
geom_point() +
geom_smooth() +
scale_x_log10()
set.seed(1)
c(maps_10_km[[1]][[5]][[1]], clay_difference) %>%
spatSample(10000) %>%
rename(
log_soc = 1,
clay_dif = 2
) %>%
ggplot(aes(x = log_soc, y = clay_dif)) +
geom_point() +
geom_smooth() +
scale_x_log10()
set.seed(1)
c(maps_10_km[[1]][[5]][[1]], clay_difference) %>%
spatSample(10000) %>%
rename(
soc = 1,
clay_dif = 2
) %>%
ggplot(aes(x = soc, y = clay_dif)) +
geom_point() +
geom_smooth() +
scale_x_log10()
set.seed(1)
c(maps_10_km[[1]][[5]][[1]], clay_difference) %>%
spatSample(100000) %>%
rename(
soc = 1,
clay_dif = 2
) %>%
ggplot(aes(x = soc, y = clay_dif)) +
geom_point() +
geom_smooth() +
scale_x_log10()
c(maps_10_km[[1]][[5]][[1]], clay_difference) %>%
spatSample(100000) %>%
rename(
soc = 1,
clay_dif = 2
) %>%
ggplot(aes(x = soc, y = clay_dif)) +
geom_point() +
geom_smooth() +
scale_x_log10() +
geom_bin2d()
c(maps_10_km[[1]][[5]][[1]], clay_difference) %>%
spatSample(100000) %>%
rename(
soc = 1,
clay_dif = 2
) %>%
ggplot(aes(x = soc, y = clay_dif)) +
geom_point(alpha = 0.5) +
geom_smooth() +
scale_x_log10()
c(maps_10_km[[1]][[5]][[1]], clay_difference) %>%
spatSample(100000) %>%
rename(
soc = 1,
clay_dif = 2
) %>%
ggplot(aes(x = soc, y = clay_dif)) +
geom_point(alpha = 0.1, pch = 19) +
geom_smooth() +
scale_x_log10()
c(maps_10_km[[1]][[5]][[1]], clay_difference) %>%
spatSample(100000) %>%
rename(
soc = 1,
clay_dif = 2
) %>%
ggplot(aes(x = soc, y = clay_dif)) +
geom_point(alpha = 0.05, shape = 19) +
geom_smooth() +
scale_x_log10()
maps_10_km[[1]][[5]][[1]]
clay_difference
geom_bin2d()
?geom_bin2d
c(maps_10_km[[1]][[5]][[1]], clay_difference) %>%
spatSample(100000) %>%
rename(
soc = 1,
clay_dif = 2
) %>%
ggplot(aes(x = soc, y = clay_dif)) +
geom_point(alpha = 0.01, shape = 19) +
geom_smooth() +
scale_x_log10()
clay_SOM_rem <- c(maps_10_km[[1]][[1]][[1]], maps_10_km[[2]][[1]][[1]])
names(clay_SOM_rem) <- c("SOM removed", "No SOM removal")
tiff(
paste0(dir_results, "/clay_SOM_rem_test_", testn, ".tiff"),
width = 16,
height = 14,
units = "cm",
res = 300
)
autoplot(clay_SOM_rem) +
scale_fill_gradientn(colours = viridis(100), na.value = NA) +
ggtitle("Clay (%), 0 - 30 cm depth") +
theme(plot.title = element_text(hjust = 0.5))
try(dev.off())
clay_difference <- maps_10_km[[1]][[1]][[1]] - maps_10_km[[2]][[1]][[1]]
names(clay_difference) <- "Clay (%) difference"
tiff(
paste0(dir_results, "/clay_difference_test_", testn, ".tiff"),
width = 16,
height = 14,
units = "cm",
res = 300
)
autoplot(clay_difference) +
scale_fill_gradientn(colours = viridis(100), na.value = NA) +
ggtitle("Effect of SOM removal, clay (%) difference") +
theme(plot.title = element_text(hjust = 0.5))
try(dev.off())
tiff(
paste0(dir_results, "/JB_SOM_rem_test_", testn, ".tiff"),
width = 16,
height = 14,
units = "cm",
res = 300
)
autoplot(JB_SOM_rem) +
scale_fill_discrete(type = cols_in_maps) +
ggtitle("JB, 0 - 30 cm depth") +
theme(plot.title = element_text(hjust = 0.5))
try(dev.off())
set.seed(1)
tiff(
paste0(dir_results, "/SOM_rem_map_cor_test_", testn, ".tiff"),
width = 16,
height = 14,
units = "cm",
res = 300
)
c(maps_10_km[[1]][[5]][[1]], clay_difference) %>%
spatSample(100000) %>%
rename(
soc = 1,
clay_dif = 2
) %>%
ggplot(aes(x = soc, y = clay_dif)) +
geom_point(alpha = 0.01, shape = 19) +
geom_smooth() +
scale_x_log10() +
xlab("SOC (%)") +
ylab("Clay (%) difference")
try(dev.off())
clay_SOM_rem <- c(maps_10_km[[1]][[1]][[1]], maps_10_km[[2]][[1]][[1]])
names(clay_SOM_rem) <- c("SOM removed", "No SOM removal")
tiff(
paste0(dir_results, "/clay_SOM_rem_test_", testn, ".tiff"),
width = 16,
height = 10,
units = "cm",
res = 300
)
autoplot(clay_SOM_rem) +
scale_fill_gradientn(colours = viridis(100), na.value = NA) +
ggtitle("Clay (%), 0 - 30 cm depth") +
theme(plot.title = element_text(hjust = 0.5))
try(dev.off())
clay_difference <- maps_10_km[[1]][[1]][[1]] - maps_10_km[[2]][[1]][[1]]
names(clay_difference) <- "Clay (%) difference"
tiff(
paste0(dir_results, "/clay_difference_test_", testn, ".tiff"),
width = 16,
height = 10,
units = "cm",
res = 300
)
autoplot(clay_difference) +
scale_fill_gradientn(colours = viridis(100), na.value = NA) +
ggtitle("Effect of SOM removal, clay (%) difference") +
theme(plot.title = element_text(hjust = 0.5))
try(dev.off())
JB_SOM_rem <- c(maps_10km_jb_list[[1]][[1]], maps_10km_jb_list[[2]][[1]])
names(JB_SOM_rem) <- c("SOM removed", "No SOM removal")
tiff(
paste0(dir_results, "/JB_SOM_rem_test_", testn, ".tiff"),
width = 16,
height = 10,
units = "cm",
res = 300
)
autoplot(JB_SOM_rem) +
scale_fill_discrete(type = cols_in_maps) +
ggtitle("JB, 0 - 30 cm depth") +
theme(plot.title = element_text(hjust = 0.5))
try(dev.off())
set.seed(1)
tiff(
paste0(dir_results, "/SOM_rem_map_cor_test_", testn, ".tiff"),
width = 16,
height = 10,
units = "cm",
res = 300
)
c(maps_10_km[[1]][[5]][[1]], clay_difference) %>%
spatSample(100000) %>%
rename(
soc = 1,
clay_dif = 2
) %>%
ggplot(aes(x = soc, y = clay_dif)) +
geom_point(alpha = 0.01, shape = 19) +
geom_smooth() +
scale_x_log10() +
xlab("SOC (%)") +
ylab("Clay (%) difference")
try(dev.off())
tiff(
paste0(dir_results, "/SOM_rem_map_cor_test_", testn, ".tiff"),
width = 16,
height = 10,
units = "cm",
res = 300
)
c(maps_10_km[[1]][[5]][[1]], clay_difference) %>%
spatSample(100000) %>%
rename(
soc = 1,
clay_dif = 2
) %>%
ggplot(aes(x = soc, y = clay_dif)) +
geom_point(alpha = 0.01, shape = 21, col = NA, bg = "black") +
geom_smooth() +
scale_x_log10() +
xlab("SOC (%)") +
ylab("Clay (%) difference")
try(dev.off())
c(maps_10_km[[1]][[5]][[1]], clay_difference) %>%
spatSample(100000) %>%
rename(
soc = 1,
clay_dif = 2
) %>%
ggplot(aes(x = soc, y = clay_dif)) +
geom_point(alpha = 0.01, shape = 21, col = NA, bg = "black") +
geom_smooth() +
scale_x_log10() +
xlab("SOC (%)") +
ylab("Clay (%) difference")
c(maps_10_km[[1]][[5]][[1]], clay_difference) %>%
spatSample(100000) %>%
rename(
soc = 1,
clay_dif = 2
) %>%
ggplot(aes(x = soc, y = clay_dif)) +
geom_point(alpha = 0.01, shape = 21, col = "black", bg = "black") +
geom_smooth() +
scale_x_log10() +
xlab("SOC (%)") +
ylab("Clay (%) difference")
try(dev.off())
c(maps_10_km[[1]][[5]][[1]], clay_difference) %>%
spatSample(100000) %>%
rename(
soc = 1,
clay_dif = 2
) %>%
ggplot(aes(x = soc, y = clay_dif)) +
geom_point(alpha = 0.01, shape = 21, col = "black", bg = "black") +
geom_smooth() +
scale_x_log10() +
xlab("SOC (%)") +
ylab("Clay (%) difference")
tiff(
paste0(dir_results, "/SOM_rem_map_cor_test_", testn, ".tiff"),
width = 16,
height = 10,
units = "cm",
res = 300
)
c(maps_10_km[[1]][[5]][[1]], clay_difference) %>%
spatSample(100000) %>%
rename(
soc = 1,
clay_dif = 2
) %>%
ggplot(aes(x = soc, y = clay_dif)) +
geom_point(alpha = 0.01, shape = 21, col = "black", bg = "black") +
geom_smooth() +
scale_x_log10() +
xlab("SOC (%)") +
ylab("Clay (%) difference")
try(dev.off())
?xgboost
models[[1]]$finalModel
