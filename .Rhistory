) +
guides(
fill = "legend"
, alpha = "legend"
) +
scale_alpha_continuous(
limits= c(0, 1),
range = c(0.05, 1),
breaks = my_breaks_dens,
na.value = 0,
trans = "sqrt"
) +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
geom_smooth(method = "lm")
pts_10k %>%
ggplot(
aes(
# x = SOC / (SOC + clay_SOMremoved),
x = log(SOC / clay_SOMremoved),
# y = clay_dif / clay_SOMremoved
y = log(clay_noremoval) - log(clay_SOMremoved)
)
) +
geom_hex(
aes(
alpha = after_stat(ndensity),
fill = after_stat(ndensity)
)
) +
scale_fill_gradientn(
colours = mycolorgradient,
aesthetics = "fill",
breaks = my_breaks_dens,
limits = c(0, 1),
na.value = 0,
trans = "sqrt"
) +
guides(
fill = "legend"
, alpha = "legend"
) +
scale_alpha_continuous(
limits= c(0, 1),
range = c(0.05, 1),
breaks = my_breaks_dens,
na.value = 0,
trans = "sqrt"
) +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
geom_smooth(method = "lm")
pts_10k %>%
ggplot(
aes(
# x = SOC / (SOC + clay_SOMremoved),
x = log(SOC / clay_SOMremoved),
# y = clay_dif / clay_SOMremoved
y = clay_noremoval / clay_SOMremoved
# y = log(clay_noremoval) - log(clay_SOMremoved)
)
) +
geom_hex(
aes(
alpha = after_stat(ndensity),
fill = after_stat(ndensity)
)
) +
scale_fill_gradientn(
colours = mycolorgradient,
aesthetics = "fill",
breaks = my_breaks_dens,
limits = c(0, 1),
na.value = 0,
trans = "sqrt"
) +
guides(
fill = "legend"
, alpha = "legend"
) +
scale_alpha_continuous(
limits= c(0, 1),
range = c(0.05, 1),
breaks = my_breaks_dens,
na.value = 0,
trans = "sqrt"
) +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
geom_smooth(method = "lm")
pts_10k %>%
ggplot(
aes(
x = SOC / (SOC + clay_SOMremoved),
# x = log(SOC / clay_SOMremoved),
# y = clay_dif / clay_SOMremoved
y = clay_noremoval / clay_SOMremoved
# y = log(clay_noremoval) - log(clay_SOMremoved)
)
) +
geom_hex(
aes(
alpha = after_stat(ndensity),
fill = after_stat(ndensity)
)
) +
scale_fill_gradientn(
colours = mycolorgradient,
aesthetics = "fill",
breaks = my_breaks_dens,
limits = c(0, 1),
na.value = 0,
trans = "sqrt"
) +
guides(
fill = "legend"
, alpha = "legend"
) +
scale_alpha_continuous(
limits= c(0, 1),
range = c(0.05, 1),
breaks = my_breaks_dens,
na.value = 0,
trans = "sqrt"
) +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
geom_smooth(method = "lm")
pts_10k %>%
ggplot(
aes(
# x = SOC / (SOC + clay_SOMremoved),
# x = log(SOC / clay_SOMremoved),
x = SOC / clay_SOMremoved,
# y = clay_dif / clay_SOMremoved
# y = clay_noremoval / clay_SOMremoved
y = SOC / clay_SOMremoved - SOC / clay_noremoval
# y = log(clay_noremoval) - log(clay_SOMremoved)
)
) +
geom_hex(
aes(
alpha = after_stat(ndensity),
fill = after_stat(ndensity)
)
) +
scale_fill_gradientn(
colours = mycolorgradient,
aesthetics = "fill",
breaks = my_breaks_dens,
limits = c(0, 1),
na.value = 0,
trans = "sqrt"
) +
guides(
fill = "legend"
, alpha = "legend"
) +
scale_alpha_continuous(
limits= c(0, 1),
range = c(0.05, 1),
breaks = my_breaks_dens,
na.value = 0,
trans = "sqrt"
) +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
geom_smooth(method = "lm")
pts_10k %>%
ggplot(
aes(
# x = SOC / (SOC + clay_SOMremoved),
# x = log(SOC / clay_SOMremoved),
# x = SOC / clay_SOMremoved,
x = log(SOC) / clay_SOMremoved,
# y = clay_dif / clay_SOMremoved
# y = clay_noremoval / clay_SOMremoved
y = SOC / clay_SOMremoved - SOC / clay_noremoval
# y = log(clay_noremoval) - log(clay_SOMremoved)
)
) +
geom_hex(
aes(
alpha = after_stat(ndensity),
fill = after_stat(ndensity)
)
) +
scale_fill_gradientn(
colours = mycolorgradient,
aesthetics = "fill",
breaks = my_breaks_dens,
limits = c(0, 1),
na.value = 0,
trans = "sqrt"
) +
guides(
fill = "legend"
, alpha = "legend"
) +
scale_alpha_continuous(
limits= c(0, 1),
range = c(0.05, 1),
breaks = my_breaks_dens,
na.value = 0,
trans = "sqrt"
) +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
geom_smooth(method = "lm")
pts_10k %>%
ggplot(
aes(
# x = SOC / (SOC + clay_SOMremoved),
# x = log(SOC / clay_SOMremoved),
# x = SOC / clay_SOMremoved,
x = log(SOC) / clay_SOMremoved,
# y = clay_dif / clay_SOMremoved
# y = clay_noremoval / clay_SOMremoved
# y = SOC / clay_SOMremoved - SOC / clay_noremoval
y = log(SOC) / clay_SOMremoved - log(SOC) / clay_noremoval
# y = log(clay_noremoval) - log(clay_SOMremoved)
)
) +
geom_hex(
aes(
alpha = after_stat(ndensity),
fill = after_stat(ndensity)
)
) +
scale_fill_gradientn(
colours = mycolorgradient,
aesthetics = "fill",
breaks = my_breaks_dens,
limits = c(0, 1),
na.value = 0,
trans = "sqrt"
) +
guides(
fill = "legend"
, alpha = "legend"
) +
scale_alpha_continuous(
limits= c(0, 1),
range = c(0.05, 1),
breaks = my_breaks_dens,
na.value = 0,
trans = "sqrt"
) +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
geom_smooth(method = "lm")
pts_10k %>%
ggplot(
aes(
# x = SOC / (SOC + clay_SOMremoved),
# x = log(SOC / clay_SOMremoved),
# x = SOC / clay_SOMremoved,
x = log(SOC) / clay_SOMremoved,
# y = clay_dif / clay_SOMremoved
# y = clay_noremoval / clay_SOMremoved
y = SOC / clay_SOMremoved - SOC / clay_noremoval
# y = log(clay_noremoval) - log(clay_SOMremoved)
)
) +
geom_hex(
aes(
alpha = after_stat(ndensity),
fill = after_stat(ndensity)
)
) +
scale_fill_gradientn(
colours = mycolorgradient,
aesthetics = "fill",
breaks = my_breaks_dens,
limits = c(0, 1),
na.value = 0,
trans = "sqrt"
) +
guides(
fill = "legend"
, alpha = "legend"
) +
scale_alpha_continuous(
limits= c(0, 1),
range = c(0.05, 1),
breaks = my_breaks_dens,
na.value = 0,
trans = "sqrt"
) +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
geom_smooth(method = "lm")
pts_10k %>%
ggplot(
aes(
x = SOC / (SOC + clay_SOMremoved),
# x = log(SOC / clay_SOMremoved),
# x = SOC / clay_SOMremoved,
# x = log(SOC) / clay_SOMremoved,
# y = clay_dif / clay_SOMremoved
# y = clay_noremoval / clay_SOMremoved
y = SOC / clay_SOMremoved - SOC / clay_noremoval
# y = log(clay_noremoval) - log(clay_SOMremoved)
)
) +
geom_hex(
aes(
alpha = after_stat(ndensity),
fill = after_stat(ndensity)
)
) +
scale_fill_gradientn(
colours = mycolorgradient,
aesthetics = "fill",
breaks = my_breaks_dens,
limits = c(0, 1),
na.value = 0,
trans = "sqrt"
) +
guides(
fill = "legend"
, alpha = "legend"
) +
scale_alpha_continuous(
limits= c(0, 1),
range = c(0.05, 1),
breaks = my_breaks_dens,
na.value = 0,
trans = "sqrt"
) +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
geom_smooth(method = "lm")
texture_2014_clay <- paste0(
"O:/AUIT_Geodata/Denmark/Natural_ressources/Soil_geology/Texture3D_2014/",
"geotiffs/aclaynor.tif"
) %>%
rast()
`vect`
?vect
pts_10k_v <- vect(
pts_10k,
geom = c("x", "y"),
crs = mycrs
)
plot(pts_10k)
plot(pts_10k_v)
pts_10k_2014extr <- terra::extract(
texture_2014_clay,
pts_10k_v
)
pts_10k_2014extr
is.na(pts_10k_2014extr$aclaynor) %>% sum()
pts_15k_v <- vect(
pts,
geom = c("x", "y"),
crs = mycrs
)
pts_15k_2014extr <- terra::extract(
texture_2014_clay,
pts_15k_v
)
pts_15k_v %>%
values() %>%
bind_cols(pts_10k_2014extr)
rm(pts_10k_2014extr)
rm(pts_10k_v)
pts_15k_v %>%
values() %>%
bind_cols(pts_15k_2014extr)
set.seed(1)
pts_15k_v %>%
values() %>%
bind_cols(pts_15k_2014extr) %>%
mutate(
clay_2014 = aclaynor
) %>%
select(
clay_SOMremoved, clay_noremoval, clay_2014
)
set.seed(1)
pts_15k_v %>%
values() %>%
bind_cols(pts_15k_2014extr) %>%
mutate(
clay_2014 = aclaynor
) %>%
select(
clay_SOMremoved, clay_noremoval, clay_2014
) %>%
drop_na() %>%
sample_n(10000)
clay_breaks2 <- c(5, 10, 15, 25, 45)
set.seed(1)
pts_15k_v %>%
values() %>%
bind_cols(pts_15k_2014extr) %>%
mutate(
clay_2014 = aclaynor
) %>%
select(
clay_SOMremoved, clay_noremoval, clay_2014
) %>%
drop_na() %>%
sample_n(10000) %>%
pivot_longer(
cols = c(clay_SOMremoved, clay_noremoval, clay_2014)
) %>%
ggplot(aes(x = value,
y = name,
fill = stat(x))) +
geom_density_ridges_gradient(
rel_min_height = 0.001,
scale = 0.95,
panel_scaling = FALSE,
bandwidth = 1
) +
scale_fill_viridis_b(breaks = clay_breaks2) +
scale_x_continuous(limits = c(0, NA), expand = c(0, 0)) +
scale_y_discrete(expand = expansion(add = c(0.1, 1)), limits = rev)
library(ggridges)
clay_breaks2 <- c(5, 10, 15, 25, 45)
set.seed(1)
pts_15k_v %>%
values() %>%
bind_cols(pts_15k_2014extr) %>%
mutate(
clay_2014 = aclaynor
) %>%
select(
clay_SOMremoved, clay_noremoval, clay_2014
) %>%
drop_na() %>%
sample_n(10000) %>%
pivot_longer(
cols = c(clay_SOMremoved, clay_noremoval, clay_2014)
) %>%
ggplot(aes(x = value,
y = name,
fill = stat(x))) +
geom_density_ridges_gradient(
rel_min_height = 0.001,
scale = 0.95,
panel_scaling = FALSE,
bandwidth = 1
) +
scale_fill_viridis_b(breaks = clay_breaks2) +
scale_x_continuous(limits = c(0, NA), expand = c(0, 0)) +
scale_y_discrete(expand = expansion(add = c(0.1, 1)), limits = rev)
df_3maps <- pts_15k_v %>%
values() %>%
bind_cols(pts_15k_2014extr) %>%
mutate(
clay_2014 = aclaynor
) %>%
select(
clay_SOMremoved, clay_noremoval, clay_2014
) %>%
drop_na() %>%
sample_n(10000) %>%
pivot_longer(
cols = c(clay_SOMremoved, clay_noremoval, clay_2014)
)
df_3maps %>%
ggplot(aes(x = value,
y = name,
fill = stat(x))) +
geom_density_ridges_gradient(
rel_min_height = 0.001,
scale = 0.95,
panel_scaling = FALSE,
bandwidth = 1
) +
scale_fill_viridis_b(breaks = clay_breaks2) +
scale_x_continuous(limits = c(0, NA), expand = c(0, 0)) +
scale_y_discrete(expand = expansion(add = c(0.1, 1)), limits = rev)
library(modeest)
df_3maps %>%
group_by(name) %>% summarise(
mode = mlv(value, method = "meanshift")
)
dir_fig <- dir_dat %>% paste0(., "/figures/") %T>% dir.create()
tiff(
paste0(dir_fig, "/Clay_2014_2024_", testn, ".tiff"),
width = 16,
height = 10,
units = "cm",
res = 300
)
df_3maps %>%
ggplot(aes(x = value,
y = name,
fill = stat(x))) +
geom_density_ridges_gradient(
rel_min_height = 0.001,
scale = 0.95,
panel_scaling = FALSE,
bandwidth = 1
) +
scale_fill_viridis_b(breaks = clay_breaks2) +
scale_x_continuous(limits = c(0, NA), expand = c(0, 0)) +
scale_y_discrete(expand = expansion(add = c(0.1, 1)), limits = rev)
try(dev.off())
