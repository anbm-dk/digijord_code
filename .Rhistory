for (i in 1:nrow(combinations_pdp)) {
pdp_plotlist2[[i]] <- pdp_outlist_combo[[i]] %>%
ggplot() +
geom_raster(aes(x = x, y = Depth, fill = yhat)) +
coord_fixed(ratio = pdp_outlist_combo[[i]]$plotratio[1], expand = FALSE) +
scale_y_reverse() +
scale_x_continuous(
expand = c(0, 0),
n.breaks = 4
) +
scale_fill_viridis_c(name = "ŷ", n.breaks = 4) +
ggtitle(frac_labels3[i]) +
xlab(cov_labels[i]) +
theme(
text = element_text(family = "serif"),
plot.title = element_markdown(),
legend.title = ggtext::element_markdown(),
legend.key.size = unit(0.5, "line"),
legend.box.spacing = unit(0.1, "line"),
legend.justification = "left",
legend.margin = margin(0, 1,0,0),
legend.box.margin=margin(-10, -10, -10,-10)
) +
guides(col = guide_colourbar(title = "ŷ"))
}
library(grid)
library(ggpubr)
figure2 <- ggarrange(
pdp_plotlist2[[1]] + rremove("ylab"),
pdp_plotlist2[[2]] + rremove("ylab"),
pdp_plotlist2[[3]] + rremove("ylab"),
pdp_plotlist2[[4]] + rremove("ylab"),
pdp_plotlist2[[5]] + rremove("ylab"),
pdp_plotlist2[[6]] + rremove("ylab"),
pdp_plotlist2[[7]] + rremove("ylab"),
pdp_plotlist2[[8]] + rremove("ylab"),
pdp_plotlist2[[9]] + rremove("ylab"),
align = "hv",
nrow = 3,
ncol = 3
) +
theme(plot.margin = margin(0, 0, 0, 0, "cm"))
# figure2
tiff(
paste0(dir_results, "/pdp_texture_depth_combo_test_", testn, ".tiff"),
width = 14,
height = 10,
units = "cm",
res = 600
)
annotate_figure(
figure2,
left = text_grob(
"Depth (cm)",
rot = 90, vjust = 1,
# gp = gpar(cex = 1.3),
family = "serif"
)
)
try(dev.off())
try(dev.off())
pdp_plotlist2 <- list()
for (i in 1:nrow(combinations_pdp)) {
pdp_plotlist2[[i]] <- pdp_outlist_combo[[i]] %>%
ggplot() +
geom_raster(aes(x = x, y = Depth, fill = yhat)) +
coord_fixed(ratio = pdp_outlist_combo[[i]]$plotratio[1], expand = FALSE) +
scale_y_reverse() +
scale_x_continuous(
expand = c(0, 0),
n.breaks = 4
) +
scale_fill_viridis_c(name = "ŷ", n.breaks = 4) +
ggtitle(frac_labels3[i]) +
xlab(cov_labels[i]) +
theme(
text = element_text(family = "serif"),
plot.title = element_markdown(),
legend.title = ggtext::element_markdown(),
legend.key.size = unit(0.5, "line"),
legend.box.spacing = unit(1, "line"),
legend.justification = "left",
legend.margin = margin(0, 0,0,0),
legend.box.margin=margin(-10, -10, -10,-10)
) +
guides(col = guide_colourbar(title = "ŷ"))
}
library(grid)
library(ggpubr)
figure2 <- ggarrange(
pdp_plotlist2[[1]] + rremove("ylab"),
pdp_plotlist2[[2]] + rremove("ylab"),
pdp_plotlist2[[3]] + rremove("ylab"),
pdp_plotlist2[[4]] + rremove("ylab"),
pdp_plotlist2[[5]] + rremove("ylab"),
pdp_plotlist2[[6]] + rremove("ylab"),
pdp_plotlist2[[7]] + rremove("ylab"),
pdp_plotlist2[[8]] + rremove("ylab"),
pdp_plotlist2[[9]] + rremove("ylab"),
align = "hv",
nrow = 3,
ncol = 3
) +
theme(plot.margin = margin(0, 0, 0, 0, "cm"))
# figure2
tiff(
paste0(dir_results, "/pdp_texture_depth_combo_test_", testn, ".tiff"),
width = 14,
height = 10,
units = "cm",
res = 600
)
annotate_figure(
figure2,
left = text_grob(
"Depth (cm)",
rot = 90, vjust = 1,
# gp = gpar(cex = 1.3),
family = "serif"
)
)
try(dev.off())
try(dev.off())
?scale_y_reverse
pdp_outlist_combo[[1]]
s2_indices <- c(1, 0, 0, 1, 0, 1, 0, 1, 0)
rbind(cov_labels, s2_indices)
cbind(cov_labels, s2_indices)
s2_indices <- c(1, 0, 0, 1, 0, 1, 0, 1, 0)
pdp_plotlist2 <- list()
for (i in 1:nrow(combinations_pdp)) {
pdp_combo_i <- pdp_outlist_combo[[i]]
if (s2_indices[i]) {
pdp_combo_i %<>%
mutate(
x = x/10^4,
plotratio = plotratio/10^4
)
}
pdp_plotlist2[[i]] <- pdp_combo_i %>%
ggplot() +
geom_raster(aes(x = x, y = Depth, fill = yhat)) +
coord_fixed(ratio = pdp_combo_i$plotratio[1], expand = FALSE) +
scale_y_reverse(breaks = c(0, 100, 200)) +
scale_x_continuous(
expand = c(0, 0),
n.breaks = 4
) +
scale_fill_viridis_c(name = "ŷ", n.breaks = 4) +
ggtitle(frac_labels3[i]) +
xlab(cov_labels[i]) +
theme(
text = element_text(family = "serif"),
plot.title = element_markdown(),
legend.title = ggtext::element_markdown(),
legend.key.size = unit(0.5, "line"),
legend.box.spacing = unit(1.5, "line"),
legend.justification = "left",
legend.margin = margin(0, 0, 0, 0),
legend.box.margin = margin(-10, -10, -10, -10)
) +
guides(col = guide_colourbar(title = "ŷ"))
}
library(grid)
library(ggpubr)
figure2 <- ggarrange(
pdp_plotlist2[[1]] + rremove("ylab"),
pdp_plotlist2[[2]] + rremove("ylab"),
pdp_plotlist2[[3]] + rremove("ylab"),
pdp_plotlist2[[4]] + rremove("ylab"),
pdp_plotlist2[[5]] + rremove("ylab"),
pdp_plotlist2[[6]] + rremove("ylab"),
pdp_plotlist2[[7]] + rremove("ylab"),
pdp_plotlist2[[8]] + rremove("ylab"),
pdp_plotlist2[[9]] + rremove("ylab"),
align = "hv",
nrow = 3,
ncol = 3
) +
theme(plot.margin = margin(0, 0, 0, 0, "cm"))
# figure2
tiff(
paste0(dir_results, "/pdp_texture_depth_combo_test_", testn, ".tiff"),
width = 14,
height = 10,
units = "cm",
res = 600
)
annotate_figure(
figure2,
left = text_grob(
"Depth (cm)",
rot = 90, vjust = 1,
# gp = gpar(cex = 1.3),
family = "serif"
)
)
try(dev.off())
try(dev.off())
s2_indices <- c(1, 0, 0, 1, 0, 1, 0, 1, 0)
pdp_plotlist2 <- list()
for (i in 1:nrow(combinations_pdp)) {
pdp_combo_i <- pdp_outlist_combo[[i]]
if (s2_indices[i]) {
pdp_combo_i %<>%
mutate(
x = x/10^4,
plotratio = plotratio/10^4
)
}
pdp_plotlist2[[i]] <- pdp_combo_i %>%
ggplot() +
geom_raster(aes(x = x, y = Depth, fill = yhat)) +
coord_fixed(ratio = pdp_combo_i$plotratio[1], expand = FALSE) +
scale_y_reverse(breaks = c(0, 100, 200)) +
scale_x_continuous(
expand = c(0, 0),
n.breaks = 3
) +
scale_fill_viridis_c(name = "ŷ", n.breaks = 4) +
ggtitle(frac_labels3[i]) +
xlab(cov_labels[i]) +
theme(
text = element_text(family = "serif"),
plot.title = element_markdown(),
legend.title = ggtext::element_markdown(),
legend.key.size = unit(0.5, "line"),
legend.box.spacing = unit(1.5, "line"),
legend.justification = "left",
legend.margin = margin(0, 0, 0, 0),
legend.box.margin = margin(-10, -10, -10, -10)
) +
guides(col = guide_colourbar(title = "ŷ"))
}
library(grid)
library(ggpubr)
figure2 <- ggarrange(
pdp_plotlist2[[1]] + rremove("ylab"),
pdp_plotlist2[[2]] + rremove("ylab"),
pdp_plotlist2[[3]] + rremove("ylab"),
pdp_plotlist2[[4]] + rremove("ylab"),
pdp_plotlist2[[5]] + rremove("ylab"),
pdp_plotlist2[[6]] + rremove("ylab"),
pdp_plotlist2[[7]] + rremove("ylab"),
pdp_plotlist2[[8]] + rremove("ylab"),
pdp_plotlist2[[9]] + rremove("ylab"),
align = "hv",
nrow = 3,
ncol = 3
) +
theme(plot.margin = margin(0, 0, 0, 0, "cm"))
# figure2
tiff(
paste0(dir_results, "/pdp_texture_depth_combo_test_", testn, ".tiff"),
width = 14,
height = 10,
units = "cm",
res = 600
)
annotate_figure(
figure2,
left = text_grob(
"Depth (cm)",
rot = 90, vjust = 1,
# gp = gpar(cex = 1.3),
family = "serif"
)
)
try(dev.off())
try(dev.off())
s2_indices <- c(1, 0, 0, 1, 0, 1, 0, 1, 0)
pdp_plotlist2 <- list()
for (i in 1:nrow(combinations_pdp)) {
pdp_combo_i <- pdp_outlist_combo[[i]]
if (s2_indices[i]) {
pdp_combo_i %<>%
mutate(
x = x/10^4,
plotratio = plotratio/10^4
)
}
pdp_plotlist2[[i]] <- pdp_combo_i %>%
ggplot() +
geom_raster(aes(x = x, y = Depth, fill = yhat)) +
coord_fixed(ratio = pdp_combo_i$plotratio[1], expand = FALSE) +
scale_y_reverse(breaks = c(0, 100, 200)) +
scale_x_continuous(
expand = c(0, 0),
breaks = range(pdp_combo_i$yhat)
) +
scale_fill_viridis_c(name = "ŷ", n.breaks = 4) +
ggtitle(frac_labels3[i]) +
xlab(cov_labels[i]) +
theme(
text = element_text(family = "serif"),
plot.title = element_markdown(),
legend.title = ggtext::element_markdown(),
legend.key.size = unit(0.5, "line"),
legend.box.spacing = unit(1.5, "line"),
legend.justification = "left",
legend.margin = margin(0, 0, 0, 0),
legend.box.margin = margin(-10, -10, -10, -10)
) +
guides(col = guide_colourbar(title = "ŷ"))
}
library(grid)
library(ggpubr)
figure2 <- ggarrange(
pdp_plotlist2[[1]] + rremove("ylab"),
pdp_plotlist2[[2]] + rremove("ylab"),
pdp_plotlist2[[3]] + rremove("ylab"),
pdp_plotlist2[[4]] + rremove("ylab"),
pdp_plotlist2[[5]] + rremove("ylab"),
pdp_plotlist2[[6]] + rremove("ylab"),
pdp_plotlist2[[7]] + rremove("ylab"),
pdp_plotlist2[[8]] + rremove("ylab"),
pdp_plotlist2[[9]] + rremove("ylab"),
align = "hv",
nrow = 3,
ncol = 3
) +
theme(plot.margin = margin(0, 0, 0, 0, "cm"))
# figure2
tiff(
paste0(dir_results, "/pdp_texture_depth_combo_test_", testn, ".tiff"),
width = 14,
height = 10,
units = "cm",
res = 600
)
annotate_figure(
figure2,
left = text_grob(
"Depth (cm)",
rot = 90, vjust = 1,
# gp = gpar(cex = 1.3),
family = "serif"
)
)
try(dev.off())
try(dev.off())
pdp_plotlist2 <- list()
for (i in 1:nrow(combinations_pdp)) {
pdp_combo_i <- pdp_outlist_combo[[i]]
if (s2_indices[i]) {
pdp_combo_i %<>%
mutate(
x = x/10^4,
plotratio = plotratio/10^4
)
}
pdp_plotlist2[[i]] <- pdp_combo_i %>%
ggplot() +
geom_raster(aes(x = x, y = Depth, fill = yhat)) +
coord_fixed(ratio = pdp_combo_i$plotratio[1], expand = FALSE) +
scale_y_reverse(breaks = c(0, 100, 200)) +
scale_x_continuous(
expand = c(0, 0),
breaks = range(pdp_combo_i$x)
) +
scale_fill_viridis_c(name = "ŷ", n.breaks = 4) +
ggtitle(frac_labels3[i]) +
xlab(cov_labels[i]) +
theme(
text = element_text(family = "serif"),
plot.title = element_markdown(),
legend.title = ggtext::element_markdown(),
legend.key.size = unit(0.5, "line"),
legend.box.spacing = unit(1.5, "line"),
legend.justification = "left",
legend.margin = margin(0, 0, 0, 0),
legend.box.margin = margin(-10, -10, -10, -10)
) +
guides(col = guide_colourbar(title = "ŷ"))
}
library(grid)
library(ggpubr)
figure2 <- ggarrange(
pdp_plotlist2[[1]] + rremove("ylab"),
pdp_plotlist2[[2]] + rremove("ylab"),
pdp_plotlist2[[3]] + rremove("ylab"),
pdp_plotlist2[[4]] + rremove("ylab"),
pdp_plotlist2[[5]] + rremove("ylab"),
pdp_plotlist2[[6]] + rremove("ylab"),
pdp_plotlist2[[7]] + rremove("ylab"),
pdp_plotlist2[[8]] + rremove("ylab"),
pdp_plotlist2[[9]] + rremove("ylab"),
align = "hv",
nrow = 3,
ncol = 3
) +
theme(plot.margin = margin(0, 0, 0, 0, "cm"))
# figure2
tiff(
paste0(dir_results, "/pdp_texture_depth_combo_test_", testn, ".tiff"),
width = 14,
height = 10,
units = "cm",
res = 600
)
annotate_figure(
figure2,
left = text_grob(
"Depth (cm)",
rot = 90, vjust = 1,
# gp = gpar(cex = 1.3),
family = "serif"
)
)
try(dev.off())
try(dev.off())
xlab_digits <- c(2, 0, 0, 2, 0, 2, 1, 2, 0)
cbind(cov_labels, s2_indices, xlab_digits)
?round
?is_not
?not
1=^1
10^1
c(
pdp_combo_i$x %>%
min() %>%
multiply_by(10^xlab_digits[i]) %>%
ceiling() %>%
divide_by(10^xlab_digits[i]),
pdp_combo_i$x %>%
max() %>%
multiply_by(10^xlab_digits[i]) %>%
floor() %>%
divide_by(10^xlab_digits[i])
)
pdp_plotlist2 <- list()
for (i in 1:nrow(combinations_pdp)) {
pdp_combo_i <- pdp_outlist_combo[[i]]
if (s2_indices[i]) {
pdp_combo_i %<>%
mutate(
x = x/10^4,
plotratio = plotratio/10^4
)
}
x_breaks <- c(
pdp_combo_i$x %>%
min() %>%
multiply_by(10^xlab_digits[i]) %>%
ceiling() %>%
divide_by(10^xlab_digits[i]),
pdp_combo_i$x %>%
max() %>%
multiply_by(10^xlab_digits[i]) %>%
floor() %>%
divide_by(10^xlab_digits[i])
)
pdp_plotlist2[[i]] <- pdp_combo_i %>%
ggplot() +
geom_raster(aes(x = x, y = Depth, fill = yhat)) +
coord_fixed(ratio = pdp_combo_i$plotratio[1], expand = FALSE) +
scale_y_reverse(breaks = c(0, 100, 200)) +
scale_x_continuous(
expand = c(0, 0),
breaks = x_breaks
) +
scale_fill_viridis_c(name = "ŷ", n.breaks = 4) +
ggtitle(frac_labels3[i]) +
xlab(cov_labels[i]) +
theme(
text = element_text(family = "serif"),
plot.title = element_markdown(),
legend.title = ggtext::element_markdown(),
legend.key.size = unit(0.5, "line"),
legend.box.spacing = unit(1.5, "line"),
legend.justification = "left",
legend.margin = margin(0, 0, 0, 0),
legend.box.margin = margin(-10, -10, -10, -10)
) +
guides(col = guide_colourbar(title = "ŷ"))
}
library(grid)
library(ggpubr)
figure2 <- ggarrange(
pdp_plotlist2[[1]] + rremove("ylab"),
pdp_plotlist2[[2]] + rremove("ylab"),
pdp_plotlist2[[3]] + rremove("ylab"),
pdp_plotlist2[[4]] + rremove("ylab"),
pdp_plotlist2[[5]] + rremove("ylab"),
pdp_plotlist2[[6]] + rremove("ylab"),
pdp_plotlist2[[7]] + rremove("ylab"),
pdp_plotlist2[[8]] + rremove("ylab"),
pdp_plotlist2[[9]] + rremove("ylab"),
align = "hv",
nrow = 3,
ncol = 3
) +
theme(plot.margin = margin(0, 0, 0, 0, "cm"))
# figure2
tiff(
paste0(dir_results, "/pdp_texture_depth_combo_test_", testn, ".tiff"),
width = 14,
height = 10,
units = "cm",
res = 600
)
annotate_figure(
figure2,
left = text_grob(
"Depth (cm)",
rot = 90, vjust = 1,
# gp = gpar(cex = 1.3),
family = "serif"
)
)
try(dev.off())
try(dev.off())
